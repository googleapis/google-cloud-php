{"id":"datastore\/query\/query","type":"","title":"Google\\Cloud\\Datastore\\Query\\Query","name":"Query","description":"<p>Represents a Cloud <a href=\"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/queries\">Datastore Query<\/a><\/p>\n<p>Queries can be created either by using the builder pattern, or by providing\na <a href=\"https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#query\">Query<\/a>\nwhen creating this object.<\/p>\n<p>Implements <a href=\"http:\/\/php.net\/manual\/en\/class.jsonserializable.php\" target=\"_blank\">JsonSerializable<\/a><\/p>","examples":[{"caption":"","code":"use Google\\Cloud\\Datastore\\DatastoreClient;\n\n$datastore = new DatastoreClient();\n\n$query = $datastore->query();\n$query->kind('Companies');\n$query->filter('companyName', '=', 'Google');\n\n$res = $datastore->runQuery($query);\nforeach ($res as $company) {\n    echo $company['companyName']; \/\/ Google\n}"},{"caption":"<p>Queries can also be constructed using a <a href=\"https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#query\">Query Object<\/a>:<\/p>","code":"$query = $datastore->query([\n    'query' => [\n        'kind' => [\n            [\n                'name' => 'Companies'\n            ]\n        ],\n        'filter' => [\n            'propertyFilter' => [\n                'op' => 'EQUAL',\n                'property' => [\n                    'name' => 'companyName'\n                ],\n                'value' => [\n                    'stringValue' => 'Google'\n                ]\n            ]\n        ]\n    ]\n]);"}],"resources":[{"title":"Query Object Reference","link":"https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#query"},{"title":"Datastore Queries","link":"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/queries"}],"methods":[{"id":"__construct","type":"constructor","name":"__construct","source":"Datastore\/src\/Query\/Query.php#L139","description":"","examples":[],"resources":[],"params":[{"name":"entityMapper","description":"<p>An instance of EntityMapper<\/p>","types":["<a data-custom-type=\"datastore\/entitymapper\">Google\\Cloud\\Datastore\\EntityMapper<\/a>"],"optional":false,"nullable":null},{"name":"query","description":"<p><a href=\"https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#query\">Query<\/a><\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":true,"nullable":null}],"exceptions":[],"returns":[]},{"id":"projection","type":"instance","name":"projection","source":"Datastore\/src\/Query\/Query.php#L165","description":"<p>Set the Query Projection.<\/p>\n<p>Accepts an array of properties. If set, only these properties will be\nreturned.<\/p>","examples":[{"caption":"","code":"$query->projection(['firstName', 'lastName']);"}],"resources":[],"params":[{"name":"properties","description":"<p>The property or properties to include in\nthe result.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"keysOnly","type":"instance","name":"keysOnly","source":"Datastore\/src\/Query\/Query.php#L190","description":"<p>Set the query to return only keys (no properties).<\/p>","examples":[{"caption":"","code":"$query->keysOnly();"}],"resources":[],"params":[],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"kind","type":"instance","name":"kind","source":"Datastore\/src\/Query\/Query.php#L213","description":"<p>Set the Kind to query.<\/p>\n<p>If empty, returns entities of all kinds. Must be set in order to filter\nresults. While you may supply as many kinds as you wish, datastore currently\nonly accepts one at a time.<\/p>","examples":[{"caption":"","code":"$query->kind('Person');"}],"resources":[],"params":[{"name":"kinds","description":"<p>The kind or kinds to return. Only a single kind\nis currently supported.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"filter","type":"instance","name":"filter","source":"Datastore\/src\/Query\/Query.php#L250","description":"<p>Add a filter to the query.<\/p>\n<p>If the top-level filter is specified as a propertyFilter, it will be replaced.\nAny composite filters will be preserved and the new filter will be added.<\/p>","examples":[{"caption":"","code":"$query->filter('firstName', '=', 'Bob')\n    ->filter('lastName', '=', 'Testguy');"}],"resources":[{"title":"Allowed Operators","link":"https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#operator_1"}],"params":[{"name":"property","description":"<p>The property to filter.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null},{"name":"operator","description":"<p>The operator to use in the filter. A list of\nallowed operators may be found\n<a href=\"https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#operator_1\">here<\/a>.\nShort comparison operators are provided for convenience and are\nmapped to their datastore-compatible equivalents. Available short\noperators are <code>=<\/code>, <code>&lt;<\/code>, <code>&lt;=<\/code>, <code>&gt;<\/code>, and <code>&gt;=<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null},{"name":"value","description":"<p>The value to check.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.pseudo-types.php#language.types.mixed\" target=\"_blank\">mixed<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"hasAncestor","type":"instance","name":"hasAncestor","source":"Datastore\/src\/Query\/Query.php#L291","description":"<p>Query for entities by their ancestors.<\/p>\n<p>Keys can be provided either via a <a data-custom-type=\"datastore\/key\">Google\\Cloud\\Datastore\\Key<\/a>\nobject, or by providing a kind, identifier and (optionally) an identifier\ntype.<\/p>","examples":[{"caption":"","code":"$key = $datastore->key('Person', 'Bob');\n$query->hasAncestor($key);"},{"caption":"<p>Specifying an identifier type<\/p>","code":"$key = $datastore->key('Robots', '1337', [\n    'identifierType' => Key::TYPE_NAME\n]);\n$query->hasAncestor($key);"}],"resources":[],"params":[{"name":"key","description":"<p>The ancestor Key instance.<\/p>","types":["<a data-custom-type=\"datastore\/key\">Google\\Cloud\\Datastore\\Key<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"order","type":"instance","name":"order","source":"Datastore\/src\/Query\/Query.php#L315","description":"<p>Specify an order for the query.<\/p>","examples":[{"caption":"","code":"$query->order('birthDate', Query::ORDER_DESCENDING);"}],"resources":[{"title":"Allowed Directions","link":"https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#Direction"}],"params":[{"name":"property","description":"<p>The property to order by.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null},{"name":"direction","description":"<p>The direction to order in. Google\nCloud PHP provides class constants which map to allowed Datastore\nvalues. Those constants are <code>Query::ORDER_DESCENDING<\/code> and\n<code>Query::ORDER_ASCENDING<\/code>. <strong>Defaults to<\/strong> <code>Query::ORDER_ACENDING<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":true,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"distinctOn","type":"instance","name":"distinctOn","source":"Datastore\/src\/Query\/Query.php#L340","description":"<p>The properties to make distinct.<\/p>\n<p>The query results will contain the first result for each distinct\ncombination of values for the given properties (if empty, all results\nare returned).<\/p>","examples":[{"caption":"","code":"$query->distinctOn('lastName');"}],"resources":[],"params":[{"name":"property","description":"<p>The property or properties to make distinct.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"start","type":"instance","name":"start","source":"Datastore\/src\/Query\/Query.php#L368","description":"<p>The starting point for the query results.<\/p>","examples":[{"caption":"","code":"$query->start($lastResultCursor);"}],"resources":[{"title":"Cursors, Limits and Offsets","link":"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/queries#cursors_limits_and_offsets"}],"params":[{"name":"cursor","description":"<p>The cursor on which to start the result.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"end","type":"instance","name":"end","source":"Datastore\/src\/Query\/Query.php#L390","description":"<p>The ending point for the query results.<\/p>","examples":[{"caption":"","code":"$query->end($lastResultCursor);"}],"resources":[{"title":"Cursors, Limits and Offsets","link":"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/queries#cursors_limits_and_offsets"}],"params":[{"name":"cursor","description":"<p>The cursor on which to end the result.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"offset","type":"instance","name":"offset","source":"Datastore\/src\/Query\/Query.php#L412","description":"<p>The number of results to skip.<\/p>","examples":[{"caption":"","code":"$query->offset(2);"}],"resources":[{"title":"Cursors, Limits and Offsets","link":"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/queries#cursors_limits_and_offsets"}],"params":[{"name":"num","description":"<p>The number of results to skip.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"limit","type":"instance","name":"limit","source":"Datastore\/src\/Query\/Query.php#L434","description":"<p>The number of results to return.<\/p>","examples":[{"caption":"","code":"$query->limit(50);"}],"resources":[{"title":"Cursors, Limits and Offsets","link":"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/queries#cursors_limits_and_offsets"}],"params":[{"name":"num","description":"<p>The number of results to return.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]}]}
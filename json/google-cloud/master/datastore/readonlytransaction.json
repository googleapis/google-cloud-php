{"id":"datastore\/readonlytransaction","type":"","title":"Google\\Cloud\\Datastore\\ReadOnlyTransaction","name":"ReadOnlyTransaction","description":"<p>Represents a Read-Only Cloud Datastore Transaction.<\/p>\n<p>Read-Only Transactions allow you to execute one or more reads at the current,\nconsistent state of Cloud Datastore at the time the transaction started.<\/p>\n<p>Read-Only Transactions in Google Cloud PHP support rollback operations, but\ndo not support commit. It should be considered best practice to rollback\nread-only transactions when you have finished using them.<\/p>\n<p>Transactions are an <strong>optional<\/strong> feature of Google Cloud Datastore. Queries,\nlookups and mutations can be executed outside of a Transaction from\n<a data-custom-type=\"datastore\/datastoreclient\">Google\\Cloud\\Datastore\\DatastoreClient<\/a>.<\/p>","examples":[{"caption":"","code":"use Google\\Cloud\\Datastore\\DatastoreClient;\n\n$datastore = new DatastoreClient();\n\n$transaction = $datastore->readOnlyTransaction();"},{"caption":"<p>Read-Only Transactions should be rolled back when they are no longer needed.<\/p>","code":"$key = $datastore->key('Users', 'Bob');\n$userData = $transaction->lookup($key);\n\n$transaction->rollback();"}],"resources":[{"title":"Transactions","link":"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/transactions"}],"methods":[{"id":"__construct","type":"constructor","name":"__construct","source":"Datastore\/src\/TransactionTrait.php#L49","description":"<p>Create a Transaction<\/p>\n\nImplemented in <a data-custom-type=\"datastore\/transactiontrait\">Google\\Cloud\\Datastore\\TransactionTrait<\/a>","examples":[],"resources":[],"params":[{"name":"operation","description":"<p>Class that handles shared API interaction.<\/p>","types":["<a data-custom-type=\"datastore\/operation\">Google\\Cloud\\Datastore\\Operation<\/a>"],"optional":false,"nullable":null},{"name":"projectId","description":"<p>The Google Cloud Platform project ID.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null},{"name":"transactionId","description":"<p>The transaction to run mutations in.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[]},{"id":"lookup","type":"instance","name":"lookup","source":"Datastore\/src\/TransactionTrait.php#L82","description":"<p>Retrieve an entity from the datastore inside a transaction<\/p>\n\nImplemented in <a data-custom-type=\"datastore\/transactiontrait\">Google\\Cloud\\Datastore\\TransactionTrait<\/a>","examples":[{"caption":"","code":"$key = $datastore->key('Person', 'Bob');\n\n$entity = $transaction->lookup($key);\nif (!is_null($entity)) {\n    echo $entity['firstName']; \/\/ 'Bob'\n}"}],"resources":[],"params":[{"name":"key","description":"<p>$key The identifier to use to locate a desired entity.<\/p>","types":["<a data-custom-type=\"datastore\/key\">Google\\Cloud\\Datastore\\Key<\/a>"],"optional":false,"nullable":null},{"name":"options","description":"<p>Configuration Options<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":true,"nullable":null},{"name":"options.className","description":"<p>The name of the class to return results as. Must be a subclass of <a data-custom-type=\"datastore\/entity\">Google\\Cloud\\Datastore\\Entity<\/a>. If not set, <a data-custom-type=\"datastore\/entity\">Google\\Cloud\\Datastore\\Entity<\/a> will be used.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":null,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/entityinterface\">Google\\Cloud\\Datastore\\EntityInterface<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.null.php\" target=\"_blank\">null<\/a>"],"description":""}]},{"id":"lookupBatch","type":"instance","name":"lookupBatch","source":"Datastore\/src\/TransactionTrait.php#L126","description":"<p>Get multiple entities inside a transaction<\/p>\n\nImplemented in <a data-custom-type=\"datastore\/transactiontrait\">Google\\Cloud\\Datastore\\TransactionTrait<\/a>","examples":[{"caption":"","code":"$keys = [\n    $datastore->key('Person', 'Bob'),\n    $datastore->key('Person', 'John')\n];\n\n$entities = $transaction->lookupBatch($keys);\n\nforeach ($entities['found'] as $entity) {\n    echo $entity['firstName'] . PHP_EOL;\n}"}],"resources":[],"params":[{"name":"keys","description":"<p>The identifiers to look up.<\/p>","types":["<a data-custom-type=\"datastore\/key\">Google\\Cloud\\Datastore\\Key[]<\/a>"],"optional":false,"nullable":null},{"name":"options","description":"<p>Configuration Options<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":true,"nullable":null},{"name":"options.className","description":"<p>If a string, the name of the class to return results as. Must be a subclass of <a data-custom-type=\"datastore\/entity\">Google\\Cloud\\Datastore\\Entity<\/a>. If not set, <a data-custom-type=\"datastore\/entity\">Google\\Cloud\\Datastore\\Entity<\/a> will be used. If an array is given, it must be an associative array, where the key is a Kind and the value is the name of a subclass of <a data-custom-type=\"datastore\/entity\">Google\\Cloud\\Datastore\\Entity<\/a>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":null,"nullable":null},{"name":"options.sort","description":"<p>If set to true, results in each set will be sorted to match the order given in $keys. <strong>Defaults to<\/strong> <code>false<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.boolean.php\" target=\"_blank\">bool<\/a>"],"optional":null,"nullable":null}],"exceptions":[],"returns":[{"types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"description":"<p>Returns an array with keys [<code>found<\/code>, <code>missing<\/code>, and <code>deferred<\/code>].\nMembers of <code>found<\/code> will be instance of\n<a data-custom-type=\"datastore\/entity\">Google\\Cloud\\Datastore\\Entity<\/a>. Members of <code>missing<\/code> and\n<code>deferred<\/code> will be instance of <a data-custom-type=\"datastore\/key\">Google\\Cloud\\Datastore\\Key<\/a>.<\/p>"}]},{"id":"runQuery","type":"instance","name":"runQuery","source":"Datastore\/src\/TransactionTrait.php#L155","description":"<p>Run a query and return entities inside a Transaction<\/p>\n\nImplemented in <a data-custom-type=\"datastore\/transactiontrait\">Google\\Cloud\\Datastore\\TransactionTrait<\/a>","examples":[{"caption":"","code":"$result = $transaction->runQuery($query);\n\nforeach ($result as $entity) {\n    echo $entity['firstName'];\n}"}],"resources":[],"params":[{"name":"query","description":"<p>The query object.<\/p>","types":["<a data-custom-type=\"datastore\/query\/queryinterface\">Google\\Cloud\\Datastore\\Query\\QueryInterface<\/a>"],"optional":false,"nullable":null},{"name":"options","description":"<p>Configuration Options<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":true,"nullable":null},{"name":"options.className","description":"<p>The name of the class to return results as. Must be a subclass of <a data-custom-type=\"datastore\/entity\">Google\\Cloud\\Datastore\\Entity<\/a>. If not set, <a data-custom-type=\"datastore\/entity\">Google\\Cloud\\Datastore\\Entity<\/a> will be used.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":null,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/entityiterator\">Google\\Cloud\\Datastore\\EntityIterator<\/a>&lt;EntityInterface&gt;"],"description":""}]},{"id":"rollback","type":"instance","name":"rollback","source":"Datastore\/src\/TransactionTrait.php#L172","description":"<p>Roll back a Transaction<\/p>\n\nImplemented in <a data-custom-type=\"datastore\/transactiontrait\">Google\\Cloud\\Datastore\\TransactionTrait<\/a>","examples":[{"caption":"","code":"$transaction->rollback();"}],"resources":[],"params":[],"exceptions":[],"returns":[{"types":["<a href=\"http:\/\/php.net\/manual\/en\/language.pseudo-types.php#language.types.void\" target=\"_blank\">void<\/a>"],"description":""}]}]}
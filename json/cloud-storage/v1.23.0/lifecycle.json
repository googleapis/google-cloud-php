{"id":"storage\/lifecycle","type":"","title":"Google\\Cloud\\Storage\\Lifecycle","name":"Lifecycle","description":"<p>Object Lifecycle Management supports common use cases like setting a Time to\nLive (TTL) for objects, archiving older versions of objects, or &quot;downgrading&quot;\nstorage classes of objects to help manage costs.<\/p>\n<p>This builder does not execute any network requests and is intended to be used\nin combination with either\n<a data-custom-type=\"cloud-storage\/v1.23.0\/storage\/storageclient\" data-method=\"createBucket\">Google\\Cloud\\Storage\\StorageClient::createBucket()<\/a>\nor <a data-custom-type=\"cloud-storage\/v1.23.0\/storage\/bucket\" data-method=\"update\">Google\\Cloud\\Storage\\Bucket::update()<\/a>.<\/p>","examples":[{"caption":"<p>Access a builder preconfigured with rules already existing on a given bucket.<\/p>","code":"use Google\\Cloud\\Storage\\StorageClient;\n\n$storage = new StorageClient();\n$bucket = $storage->bucket('my-bucket');\n$lifecycle = $bucket->currentLifecycle();"},{"caption":"<p>Or get a fresh builder by using the static factory method.<\/p>","code":"use Google\\Cloud\\Storage\\Bucket;\n\n$lifecycle = Bucket::lifecycle();"}],"resources":[{"title":"Object Lifecycle Management API Documentation","link":"https:\/\/cloud.google.com\/storage\/docs\/lifecycle"}],"methods":[{"id":"__construct","type":"constructor","name":"__construct","source":"Storage\/src\/Lifecycle.php#L64","description":"","examples":[],"resources":[],"params":[{"name":"lifecycle","description":"<p>A lifecycle configuration. Please see\n<a href=\"https:\/\/cloud.google.com\/storage\/docs\/json_api\/v1\/buckets#lifecycle\">here<\/a>\nfor the expected structure.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":true,"nullable":null}],"exceptions":[],"returns":[]},{"id":"addDeleteRule","type":"instance","name":"addDeleteRule","source":"Storage\/src\/Lifecycle.php#L126","description":"<p>Adds an Object Lifecycle Delete Rule.<\/p>","examples":[{"caption":"","code":"$lifecycle->addDeleteRule([\n    'age' => 50,\n    'isLive' => true\n]);"}],"resources":[],"params":[{"name":"condition","description":"<p>The condition(s) where the rule will apply.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":false,"nullable":null},{"name":"condition.age","description":"<p>Age of an object (in days). This condition is satisfied when an object reaches the specified age.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":null,"nullable":null},{"name":"condition.createdBefore","description":"<p>This condition is satisfied when an object is created before midnight of the specified date in UTC. If a string is given, it must be a date in RFC 3339 format with only the date part (for instance, &quot;2013-01-15&quot;).<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/class.datetimeinterface.php\" target=\"_blank\">DateTimeInterface<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":null,"nullable":null},{"name":"condition.customTimeBefore","description":"<p>This condition is satisfied when the custom time on an object is before this date in UTC. If a string is given, it must be a date in RFC 3339 format with only the date part (for instance, &quot;2013-01-15&quot;).<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/class.datetimeinterface.php\" target=\"_blank\">DateTimeInterface<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":null,"nullable":null},{"name":"condition.daysSinceCustomTime","description":"<p>Number of days elapsed since the user-specified timestamp set on an object. The condition is satisfied if the days elapsed is at least this number. If no custom timestamp is specified on an object, the condition does not apply.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":null,"nullable":null},{"name":"condition.daysSinceNoncurrentTime","description":"<p>Number of days elapsed since the noncurrent timestamp of an object. The condition is satisfied if the days elapsed is at least this number. This condition is relevant only for versioned objects. The value of the field must be a nonnegative integer. If it's zero, the object version will become eligible for Lifecycle action as soon as it becomes noncurrent.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":null,"nullable":null},{"name":"condition.isLive","description":"<p>Relevant only for versioned objects. If the value is <code>true<\/code>, this condition matches live objects; if the value is <code>false<\/code>, it matches archived objects.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.boolean.php\" target=\"_blank\">bool<\/a>"],"optional":null,"nullable":null},{"name":"condition.matchesStorageClass","description":"<p>Objects having any of the storage classes specified by this condition will be matched. Values include <code>\"MULTI_REGIONAL\"<\/code>, <code>\"REGIONAL\"<\/code>, <code>\"NEARLINE\"<\/code>, <code>\"ARCHIVE\"<\/code>, <code>\"COLDLINE\"<\/code>, <code>\"STANDARD\"<\/code>, and <code>\"DURABLE_REDUCED_AVAILABILITY\"<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string[]<\/a>"],"optional":null,"nullable":null},{"name":"condition.noncurrentTimeBefore","description":"<p>This condition is satisfied when the noncurrent time on an object is before this timestamp. This condition is relevant only for versioned objects. If a string is given, it must be a date in RFC 3339 format with only the date part (for instance, &quot;2013-01-15&quot;).<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/class.datetimeinterface.php\" target=\"_blank\">DateTimeInterface<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":null,"nullable":null},{"name":"condition.numNewerVersions","description":"<p>Relevant only for versioned objects. If the value is N, this condition is satisfied when there are at least N versions (including the live version) newer than this version of the object.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":null,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"cloud-storage\/v1.23.0\/storage\/lifecycle\">Google\\Cloud\\Storage\\Lifecycle<\/a>"],"description":""}]},{"id":"addSetStorageClassRule","type":"instance","name":"addSetStorageClassRule","source":"Storage\/src\/Lifecycle.php#L216","description":"<p>Adds an Object Lifecycle Set Storage Class Rule.<\/p>","examples":[{"caption":"","code":"$lifecycle->addSetStorageClassRule('COLDLINE', [\n    'age' => 50,\n    'isLive' => true\n]);"},{"caption":"<p>Using customTimeBefore rule with an object's custom time setting.<\/p>","code":"$lifecycle->addSetStorageClassRule('NEARLINE', [\n    'customTimeBefore' => (new \\DateTime())->add(\n        \\DateInterval::createFromDateString('+10 days')\n    )\n]);\n\n$bucket->update(['lifecycle' => $lifecycle]);\n\n$object = $bucket->object($objectName);\n$object->update([\n    'metadata' => [\n        'customTime' => '2020-08-17'\n    ]\n]);"}],"resources":[],"params":[{"name":"storageClass","description":"<p>The target storage class. Values include\n<code>\"MULTI_REGIONAL\"<\/code>, <code>\"REGIONAL\"<\/code>, <code>\"NEARLINE\"<\/code>, <code>\"COLDLINE\"<\/code>,\n<code>\"STANDARD\"<\/code>, and <code>\"DURABLE_REDUCED_AVAILABILITY\"<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null},{"name":"condition","description":"<p>The condition(s) where the rule will apply.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":false,"nullable":null},{"name":"condition.age","description":"<p>Age of an object (in days). This condition is satisfied when an object reaches the specified age.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":null,"nullable":null},{"name":"condition.createdBefore","description":"<p>This condition is satisfied when an object is created before midnight of the specified date in UTC. If a string is given, it must be a date in RFC 3339 format with only the date part (for instance, &quot;2013-01-15&quot;).<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/class.datetimeinterface.php\" target=\"_blank\">DateTimeInterface<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":null,"nullable":null},{"name":"condition.customTimeBefore","description":"<p>This condition is satisfied when the custom time on an object is before this date in UTC. If a string is given, it must be a date in RFC 3339 format with only the date part (for instance, &quot;2013-01-15&quot;).<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/class.datetimeinterface.php\" target=\"_blank\">DateTimeInterface<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":null,"nullable":null},{"name":"condition.daysSinceCustomTime","description":"<p>Number of days elapsed since the user-specified timestamp set on an object. The condition is satisfied if the days elapsed is at least this number. If no custom timestamp is specified on an object, the condition does not apply.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":null,"nullable":null},{"name":"condition.daysSinceNoncurrentTime","description":"<p>Number of days elapsed since the noncurrent timestamp of an object. The condition is satisfied if the days elapsed is at least this number. This condition is relevant only for versioned objects. The value of the field must be a nonnegative integer. If it's zero, the object version will become eligible for Lifecycle action as soon as it becomes noncurrent.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":null,"nullable":null},{"name":"condition.isLive","description":"<p>Relevant only for versioned objects. If the value is <code>true<\/code>, this condition matches live objects; if the value is <code>false<\/code>, it matches archived objects.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.boolean.php\" target=\"_blank\">bool<\/a>"],"optional":null,"nullable":null},{"name":"condition.matchesStorageClass","description":"<p>Objects having any of the storage classes specified by this condition will be matched. Values include <code>\"MULTI_REGIONAL\"<\/code>, <code>\"REGIONAL\"<\/code>, <code>\"NEARLINE\"<\/code>, <code>\"ARCHIVE\"<\/code>, <code>\"COLDLINE\"<\/code>, <code>\"STANDARD\"<\/code>, and <code>\"DURABLE_REDUCED_AVAILABILITY\"<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string[]<\/a>"],"optional":null,"nullable":null},{"name":"condition.noncurrentTimeBefore","description":"<p>This condition is satisfied when the noncurrent time on an object is before this timestamp. This condition is relevant only for versioned objects. If a string is given, it must be a date in RFC 3339 format with only the date part (for instance, &quot;2013-01-15&quot;).<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/class.datetimeinterface.php\" target=\"_blank\">DateTimeInterface<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":null,"nullable":null},{"name":"condition.numNewerVersions","description":"<p>Relevant only for versioned objects. If the value is N, this condition is satisfied when there are at least N versions (including the live version) newer than this version of the object.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":null,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"cloud-storage\/v1.23.0\/storage\/lifecycle\">Google\\Cloud\\Storage\\Lifecycle<\/a>"],"description":""}]},{"id":"clearRules","type":"instance","name":"clearRules","source":"Storage\/src\/Lifecycle.php#L267","description":"<p>Clear all Object Lifecycle rules or rules of a certain action type.<\/p>","examples":[{"caption":"<p>Remove all rules.<\/p>","code":"$lifecycle->clearRules();"},{"caption":"<p>Remove all &quot;Delete&quot; based rules.<\/p>","code":"$lifecycle->clearRules('Delete');"},{"caption":"<p>Clear any rules which have an age equal to 50.<\/p>","code":"$lifecycle->clearRules(function (array $rule) {\n    return $rule['condition']['age'] === 50\n        ? false\n        : true;\n});"}],"resources":[],"params":[{"name":"action","description":"<p>If a string is provided, it\nmust be the name of the type of rule to remove (<code>SetStorageClass<\/code>\nor <code>Delete<\/code>). All rules of this type will then be cleared. When\nproviding a callable you may define a custom route for how you\nwould like to remove rules. The provided callable will be run\nthrough\n<a href=\"http:\/\/php.net\/manual\/en\/function.array-filter.php\">array_filter<\/a>.\nThe callable's argument will be a single lifecycle rule as an\nassociative array. When returning true from the callable the rule\nwill be preserved, and if false it will be removed.\n<strong>Defaults to<\/strong> <code>null<\/code>, clearing all assigned rules.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.callable.php\" target=\"_blank\">callable<\/a>"],"optional":true,"nullable":null}],"exceptions":[{"type":"\\InvalidArgumentException","description":"If a type other than a string or\n        callabe is provided."}],"returns":[{"types":["<a data-custom-type=\"cloud-storage\/v1.23.0\/storage\/lifecycle\">Google\\Cloud\\Storage\\Lifecycle<\/a>"],"description":""}]}]}
{"id":"pubsub\/pubsubclient","type":"","title":"Google\\Cloud\\PubSub\\PubSubClient","name":"PubSubClient","description":"<p>Google Cloud Pub\/Sub allows you to send and receive\nmessages between independent applications. Find more information at the\n<a href=\"https:\/\/cloud.google.com\/pubsub\/docs\/\">Google Cloud Pub\/Sub docs<\/a>.<\/p>\n<p>To enable the <a href=\"https:\/\/cloud.google.com\/pubsub\/emulator\">Google Cloud Pub\/Sub Emulator<\/a>,\nset the <a href=\"https:\/\/cloud.google.com\/pubsub\/emulator#env\"><code>PUBSUB_EMULATOR_HOST<\/code><\/a>\nenvironment variable.<\/p>\n<p>This client supports transport over\n<a href=\"https:\/\/cloud.google.com\/pubsub\/docs\/reference\/rest\/\">REST<\/a> or\n<a href=\"https:\/\/cloud.google.com\/pubsub\/docs\/reference\/rpc\/\">gRPC<\/a>.<\/p>\n<p>In order to enable gRPC support please make sure to install and enable\nthe gRPC extension through PECL:<\/p>\n<pre><code class=\"language-sh\">$ pecl install grpc<\/code><\/pre>\n<p>Afterwards, please install the following dependencies through composer:<\/p>\n<pre><code class=\"language-sh\">$ composer require google\/gax &amp;&amp; composer require google\/proto-client-php<\/code><\/pre>\n<p>Please take care in installing the same version of these libraries that are\noutlined in the project's composer.json require-dev keyword.<\/p>\n<p>NOTE: Support for gRPC is currently at an Alpha quality level, meaning it is still\na work in progress and is more likely to get backwards-incompatible updates.<\/p>","examples":[{"caption":"","code":"use Google\\Cloud\\ServiceBuilder;\n\n$cloud = new ServiceBuilder();\n\n$pubsub = $cloud->pubsub();"},{"caption":"<p>PubSubClient can be instantiated directly.<\/p>","code":"use Google\\Cloud\\PubSub\\PubSubClient;\n\n$pubsub = new PubSubClient();"},{"caption":"<p>Using the Pub\/Sub Emulator<\/p>","code":"use Google\\Cloud\\ServiceBuilder;\n\n\/\/ Be sure to use the port specified when starting the emulator.\n\/\/ `8900` is used as an example only.\nputenv('PUBSUB_EMULATOR_HOST=http:\/\/localhost:8900');\n\n$cloud = new ServiceBuilder();\n$pubsub = $cloud->pubsub();"}],"resources":[],"methods":[{"id":"__construct","type":"constructor","name":"__construct","source":"\/src\/PubSub\/PubSubClient.php#L134","description":"<p>Create a PubSub client.<\/p>","examples":[],"resources":[],"params":[{"name":"config","description":"<p>Configuration Options.<\/p>","types":["array"],"optional":true,"nullable":null},{"name":"config.projectId","description":"<p>The project ID from the Google Developer's Console.<\/p>","types":["string"],"optional":null,"nullable":null},{"name":"config.authCache","description":"<p>A cache for storing access tokens. <strong>Defaults to<\/strong> a simple in memory implementation.<\/p>","types":["CacheItemPoolInterface"],"optional":null,"nullable":null},{"name":"config.authCacheOptions","description":"<p>Cache configuration options.<\/p>","types":["array"],"optional":null,"nullable":null},{"name":"config.authHttpHandler","description":"<p>A handler used to deliver Psr7 requests specifically for authentication.<\/p>","types":["callable"],"optional":null,"nullable":null},{"name":"config.httpHandler","description":"<p>A handler used to deliver Psr7 requests. Only valid for requests sent over REST.<\/p>","types":["callable"],"optional":null,"nullable":null},{"name":"config.keyFile","description":"<p>The contents of the service account credentials .json file retrieved from the Google Developer's Console. Ex: <code>json_decode(file_get_contents($path), true)<\/code>.<\/p>","types":["array"],"optional":null,"nullable":null},{"name":"config.keyFilePath","description":"<p>The full path to your service account credentials .json file retrieved from the Google Developers Console.<\/p>","types":["string"],"optional":null,"nullable":null},{"name":"config.retries","description":"<p>Number of retries for a failed request. <strong>Defaults to<\/strong> <code>3<\/code>.<\/p>","types":["int"],"optional":null,"nullable":null},{"name":"config.scopes","description":"<p>Scopes to be used for the request.<\/p>","types":["array"],"optional":null,"nullable":null},{"name":"config.transport","description":"<p>The transport type used for requests. May be either <code>grpc<\/code> or <code>rest<\/code>. <strong>Defaults to<\/strong> <code>grpc<\/code> if gRPC support is detected on the system.<\/p>","types":["string"],"optional":null,"nullable":null}],"exceptions":[{"type":"\\InvalidArgumentException","description":""}],"returns":[]},{"id":"createTopic","type":"instance","name":"createTopic","source":"\/src\/PubSub\/PubSubClient.php#L169","description":"<p>Create a topic.<\/p>\n<p>Unlike <a data-custom-type=\"pubsub\/pubsubclient\" data-method=\"topic\">Google\\Cloud\\PubSub\\PubSubClient::topic()<\/a>, this method will send an API call to\ncreate the topic. If the topic already exists, an exception will be\nthrown. When in doubt, use <a data-custom-type=\"pubsub\/pubsubclient\" data-method=\"topic\">Google\\Cloud\\PubSub\\PubSubClient::topic()<\/a>.<\/p>","examples":[{"caption":"","code":"$topic = $pubsub->createTopic('my-new-topic');\necho $topic->info()['name']; \/\/ `projects\/my-awesome-project\/topics\/my-new-topic`"}],"resources":[{"title":"Create Topic","link":"https:\/\/cloud.google.com\/pubsub\/docs\/reference\/rest\/v1\/projects.topics\/create"}],"params":[{"name":"name","description":"<p>The topic name<\/p>","types":["string"],"optional":false,"nullable":null},{"name":"options","description":"<p>Configuration Options<\/p>","types":["array"],"optional":true,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"pubsub\/topic\">Google\\Cloud\\PubSub\\Topic<\/a>"],"description":""}]},{"id":"topic","type":"instance","name":"topic","source":"\/src\/PubSub\/PubSubClient.php#L195","description":"<p>Lazily instantiate a topic with a topic name.<\/p>\n<p>No API requests are made by this method. If you want to create a new\ntopic, use <a data-custom-type=\"pubsub\/topic\" data-method=\"createTopic\">Google\\Cloud\\PubSub\\Topic::createTopic()<\/a>.<\/p>","examples":[{"caption":"<p>No API request yet!<\/p>","code":"$topic = $pubsub->topic('my-new-topic');\n\n\/\/ This will execute an API call.\necho $topic->info()['name']; \/\/ `projects\/my-awesome-project\/topics\/my-new-topic`"}],"resources":[],"params":[{"name":"name","description":"<p>The topic name<\/p>","types":["string"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"pubsub\/topic\">Google\\Cloud\\PubSub\\Topic<\/a>"],"description":""}]},{"id":"topics","type":"instance","name":"topics","source":"\/src\/PubSub\/PubSubClient.php#L222","description":"<p>Get a list of the topics registered to your project.<\/p>","examples":[{"caption":"","code":"$topics = $pubsub->topics();\nforeach ($topics as $topic) {\n    $info = $topic->info();\n    echo $info['name']; \/\/ `projects\/my-awesome-project\/topics\/my-new-topic`\n}"}],"resources":[{"title":"List Topics","link":"https:\/\/cloud.google.com\/pubsub\/docs\/reference\/rest\/v1\/projects.topics\/list"}],"params":[{"name":"options","description":"<p>Configuration Options<\/p>","types":["array"],"optional":true,"nullable":null},{"name":"options.pageSize","description":"<p>Maximum number of results to return per request.<\/p>","types":["int"],"optional":null,"nullable":null}],"exceptions":[],"returns":[{"types":["Generator&lt;<a data-custom-type=\"pubsub\/topic\">Google\\Cloud\\PubSub\\Topic<\/a>&gt;"],"description":""}]},{"id":"subscribe","type":"instance","name":"subscribe","source":"\/src\/PubSub\/PubSubClient.php#L264","description":"<p>Create a Subscription. If the subscription does not exist, it will be\ncreated.<\/p>\n<p>Use <a data-custom-type=\"pubsub\/pubsubclient\" data-method=\"subscription\">Google\\Cloud\\PubSub\\PubSubClient::subscription()<\/a> to create a subscription object\nwithout any API requests. If the topic already exists, an exception will\nbe thrown. When in doubt, use <a data-custom-type=\"pubsub\/pubsubclient\" data-method=\"subscription\">Google\\Cloud\\PubSub\\PubSubClient::subscription()<\/a>.<\/p>","examples":[{"caption":"<p>Create a subscription. If it doesn't exist in the API, it will be created.<\/p>","code":"$subscription = $pubsub->subscribe('my-new-subscription', 'my-topic-name');"}],"resources":[{"title":"Create Subscription","link":"https:\/\/cloud.google.com\/pubsub\/docs\/reference\/rest\/v1\/projects.subscriptions\/create"}],"params":[{"name":"name","description":"<p>A subscription name<\/p>","types":["string"],"optional":false,"nullable":null},{"name":"topicName","description":"<p>The topic to which the new subscription will be subscribed.<\/p>","types":["string"],"optional":false,"nullable":null},{"name":"options","description":"<p>Please see <a data-custom-type=\"pubsub\/subscription\" data-method=\"create\">Google\\Cloud\\PubSub\\Subscription::create()<\/a>\nfor configuration details.<\/p>","types":["array"],"optional":true,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"pubsub\/subscription\">Google\\Cloud\\PubSub\\Subscription<\/a>"],"description":""}]},{"id":"subscription","type":"instance","name":"subscription","source":"\/src\/PubSub\/PubSubClient.php#L290","description":"<p>Lazily instantiate a subscription with a subscription name.<\/p>\n<p>This method will NOT perform any API calls. If you wish to create a new\nsubscription, use <a data-custom-type=\"pubsub\/pubsubclient\" data-method=\"subscribe\">Google\\Cloud\\PubSub\\PubSubClient::subscribe()<\/a>.<\/p>\n<p>Unless you are sure the subscription exists, you should check its\nexistence before using it.<\/p>","examples":[{"caption":"","code":"$subscription = $pubsub->subscription('my-new-subscription');"}],"resources":[],"params":[{"name":"name","description":"<p>The subscription name<\/p>","types":["string"],"optional":false,"nullable":null},{"name":"topicName","description":"<p>The topic name<\/p>","types":["string"],"optional":true,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"pubsub\/subscription\">Google\\Cloud\\PubSub\\Subscription<\/a>"],"description":""}]},{"id":"subscriptions","type":"instance","name":"subscriptions","source":"\/src\/PubSub\/PubSubClient.php#L318","description":"<p>Get a list of the subscriptions registered to all of your project's\ntopics.<\/p>","examples":[{"caption":"","code":"$subscriptions = $pubsub->subscriptions();\nforeach ($subscriptions as $subscription) {\n     $info = $subscription->info();\n     echo $info['name']; \/\/ `projects\/my-awesome-project\/subscriptions\/<subscription-name>`\n}"}],"resources":[{"title":"List Subscriptions","link":"https:\/\/cloud.google.com\/pubsub\/docs\/reference\/rest\/v1\/projects.subscriptions\/list"}],"params":[{"name":"options","description":"<p>Configuration Options<\/p>","types":["array"],"optional":true,"nullable":null},{"name":"options.pageSize","description":"<p>Maximum number of results to return per request.<\/p>","types":["int"],"optional":null,"nullable":null}],"exceptions":[],"returns":[{"types":["Generator&lt;<a data-custom-type=\"pubsub\/subscription\">Google\\Cloud\\PubSub\\Subscription<\/a>&gt;"],"description":""}]},{"id":"consume","type":"instance","name":"consume","source":"\/src\/PubSub\/PubSubClient.php#L358","description":"<p>Consume an incoming message and return a PubSub Message.<\/p>\n<p>This method is for use with push delivery only.<\/p>","examples":[{"caption":"","code":"$httpPostRequestBody = file_get_contents('php:\/\/input');\n$requestData = json_decode($httpPostRequestBody, true);\n\n$message = $pubsub->consume($requestData);"}],"resources":[],"params":[{"name":"requestBody","description":"<p>The HTTP Request body<\/p>","types":["array"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"pubsub\/message\">Google\\Cloud\\PubSub\\Message<\/a>"],"description":""}]}]}
#!/usr/bin/env php
<?php
/**
 * Copyright 2016 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

if (!file_exists(__DIR__ . '/vendor/autoload.php')) {
    exit('run composer in the "dev" directory (e.g. composer install -d dev)');
}

require __DIR__ . '/vendor/autoload.php';

use Google\Cloud\Dev\Command\ComponentAddVersionCommand;
use Google\Cloud\Dev\Command\ComponentExecuteCommand;
use Google\Cloud\Dev\Command\ComponentInfoCommand;
use Google\Cloud\Dev\Command\ComponentNewCommand;
use Google\Cloud\Dev\Command\ComponentUpdateCommand;
use Google\Cloud\Dev\Command\ComponentUpdateReadmeSampleCommand;
use Google\Cloud\Dev\Command\ComponentUpdateDepsCommand;
use Google\Cloud\Dev\Command\DocFxCommand;
use Google\Cloud\Dev\Command\ReleaseInfoCommand;
use Google\Cloud\Dev\Command\ReleaseVerifyCommand;
use Google\Cloud\Dev\Command\RepoComplianceCommand;
use Google\Cloud\Dev\Command\RepoSplitCommand;
use Symfony\Component\Console\Application;

if (!class_exists(Application::class)) {
    throw new RuntimeException(
        'Symfony Console Component not installed. ' .
        'run "composer install" or "composer update", making sure not to ' .
        'exclude dev dependencies, and try again.'
    );
}

$rootDirectory = realpath(__DIR__ . '/../') . '/';

$app = new Application;
$app->add(new ComponentInfoCommand());
$app->add(new ComponentAddVersionCommand($rootDirectory));
$app->add(new ComponentExecuteCommand());
$app->add(new ComponentNewCommand($rootDirectory));
$app->add(new ComponentUpdateCommand($rootDirectory));
$app->add(new ComponentUpdateReadmeSampleCommand($rootDirectory));
$app->add(new ComponentUpdateDepsCommand());
$app->add(new DocFxCommand());
$app->add(new ReleaseInfoCommand());
$app->add(new ReleaseVerifyCommand());
$app->add(new RepoComplianceCommand());
$app->add(new RepoSplitCommand($rootDirectory));
$app->run();
